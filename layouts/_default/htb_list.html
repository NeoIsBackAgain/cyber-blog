{{ define "main" }}
<div class="notion-layout">

    <!-- <div class="notion-cover">
        <img src="https://images.unsplash.com/photo-1550751827-4bd374c3f58b?q=80&w=2070&auto=format&fit=crop" alt="Cover">
        <div class="cover-overlay"></div>
    </div> -->

    <div class="notion-header">
        <div class="header-top-row">
            <div class="icon-container">
                <img src="/ob/htb.gif" class="header-icon" alt="HTB">
            </div>
        </div>
        
        <h1 class="page-title">HackTheBox Collection</h1>
        
        <div class="notion-meta">
            <span class="meta-item">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
                @NeoIsBackAgain
            </span>
            <span class="meta-divider">â€¢</span>
            <span class="meta-item">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg>
                {{ len (where .Site.RegularPages "Params.tags" "intersect" (slice "HTB" "HackTheBox")) }} Machines Pwned
            </span>
        </div>

        <div class="notion-quote">
            <blockquote>
                "Hack The Box is a gamified cybersecurity upskilling platform."
                <a href="https://www.hackthebox.com" target="_blank" class="quote-link">hackthebox.com â†—</a>
            </blockquote>
        </div>
    </div>

    <div class="notion-body">
        <div class="list-header-row">
            <span class="col-name">MACHINE NAME</span>
            <span class="col-tags">TAGS & DIFFICULTY</span>
        </div>
        
        <div class="machine-rows">
            {{ $pages := where .Site.RegularPages "Params.tags" "intersect" (slice "HTB" "HackTheBox") }}
            {{ range $pages }}
            <a href="{{ .Permalink }}" class="notion-row">
                <div class="row-left">
                    <span class="row-icon">
                        {{ if .Params.icon }}
                            <img src="{{ .Params.icon | absURL }}">
                        
                        {{ else if or (in .Params.tags "Windows") (in .Params.tags "windows") }}
                            <svg viewBox="0 0 448 512" fill="#0078d7" style="padding: 2px;">
                                <path d="M0 93.7l183.6-25.3v177.4H0V93.7zm0 324.6l183.6 25.3V268.4H0v149.9zm203.8 28L448 480V268.4H203.8v177.9zm0-380.6v180.1H448V32L203.8 65.7z"/>
                            </svg>

                        {{ else if or (in .Params.tags "Linux") (in .Params.tags "linux") }}
                            <svg viewBox="0 0 448 512" fill="#f0ad4e">
                                <path d="M88 304H80V256H88C101.3 256 112 245.3 112 232V224H128V232C128 245.3 138.7 256 152 256H160V304H152C132.4 304 115.2 315.1 106.3 332.1C102.3 339.7 94.3 344.4 85.8 344.4H80V304H88zM360 304H368V344.4H362.2C353.7 344.4 345.7 339.7 341.7 332.1C332.8 315.1 315.6 304 296 304H288V256H296C309.3 256 320 245.3 320 232V224H336V232C336 245.3 346.7 256 360 256H368V304H360zM224 0C135.6 0 64 71.6 64 160V230.8C64 250.6 38.6 261.2 23.3 248.6C8.8 236.6 0 248.8 0 263.6C0 274.6 7.4 284.3 17.8 286.8L53.7 295.5C59.6 296.9 64 302.2 64 308.3V388.9C64 430.4 87.8 468.6 126.5 488.2L149.4 499.8C154 502.1 159.2 501.9 163.7 499.3L208 473.6V392C208 383.2 215.2 376 224 376C232.8 376 240 383.2 240 392V473.6L284.3 499.3C288.8 501.9 294 502.1 298.6 499.8L321.5 488.2C360.2 468.6 384 430.4 384 388.9V308.3C384 302.2 388.4 296.9 394.3 295.5L430.2 286.8C440.6 284.3 448 274.6 448 263.6C448 248.8 439.2 236.6 424.7 248.6C409.4 261.2 384 250.6 384 230.8V160C384 71.6 312.4 0 224 0z"/>
                            </svg>

                        {{ else }}
                            <span class="default-icon">ðŸ“¦</span>
                        {{ end }}
                    </span>
                    <span class="row-title">{{ .Title }}</span>
                </div>

                <div class="row-right">
                    {{ if or (in .Params.tags "Easy") (in .Params.tags "easy") }}<span class="tag easy">Easy</span>{{ end }}
                    {{ if or (in .Params.tags "Medium") (in .Params.tags "medium") }}<span class="tag medium">Medium</span>{{ end }}
                    {{ if or (in .Params.tags "Hard") (in .Params.tags "hard") }}<span class="tag hard">Hard</span>{{ end }}
                    {{ if or (in .Params.tags "Insane") (in .Params.tags "insane") }}<span class="tag insane">Insane</span>{{ end }}
                    
                    {{ if or (in .Params.tags "Windows") (in .Params.tags "windows") }}<span class="tag os windows">Win</span>{{ end }}
                    {{ if or (in .Params.tags "Linux") (in .Params.tags "linux") }}<span class="tag os linux">Linux</span>{{ end }}
                </div>
            </a>
            {{ end }}
        </div>
    </div>
</div>

<style>
    /* --- Base Layout --- */
    .notion-layout {
        max-width: 900px;
        margin: 0 auto;
        padding-bottom: 50px;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif;
        color: #e0e0e0;
    }

    /* --- Cover Image --- */
    .notion-cover {
        position: relative;
        height: 240px;
        width: 100%;
        overflow: hidden;
    }

    .notion-cover img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        opacity: 0.8;
    }
    
    .cover-overlay {
        position: absolute;
        bottom: 0; left: 0; width: 100%; height: 30%;
        background: linear-gradient(to bottom, transparent, #121212);
    }

    /* --- Header --- */
    .notion-header {
        padding: 0 40px;
        margin-top: -30px; 
    }

    .icon-container {
        width: 80px;
        height: 80px;
        margin-bottom: 15px;
        position: relative; 
        z-index: 5;
    }

    .header-icon {
        width: 100%;
        height: 100%;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.5);
        background: #121212;
    }

    .page-title {
        font-size: 2.5rem;
        font-weight: 700;
        margin: 0 0 10px 0;
        letter-spacing: -0.02em;
        color: #fff;
    }

    .notion-meta {
        display: flex;
        align-items: center;
        gap: 8px;
        color: #888;
        font-size: 0.9rem;
        margin-bottom: 25px;
    }

    .meta-item {
        display: flex;
        align-items: center;
        gap: 6px;
    }

    .meta-divider { color: #444; }

    .notion-quote {
        border-left: 3px solid #333;
        padding-left: 14px;
        color: #aaa;
        font-style: italic;
        margin-bottom: 40px;
    }
    
    .quote-link {
        color: #1e90ff;
        text-decoration: none;
        font-style: normal;
        margin-left: 5px;
        font-size: 0.85em;
    }

    /* --- List / Database View --- */
    .notion-body {
        padding: 0 40px;
    }

    .list-header-row {
        display: flex;
        justify-content: space-between;
        padding: 0 10px 8px 10px;
        border-bottom: 1px solid #333;
        color: #666;
        font-size: 0.75rem;
        text-transform: uppercase;
        font-weight: 600;
        letter-spacing: 0.05em;
    }

    .machine-rows {
        display: flex;
        flex-direction: column;
    }

    .notion-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 10px;
        border-bottom: 1px solid #1a1a1a;
        text-decoration: none;
        transition: background 0.15s ease;
        border-radius: 4px;
    }

    .notion-row:hover {
        background: rgba(255, 255, 255, 0.03);
    }

    .row-left {
        display: flex;
        align-items: center;
        gap: 12px;
    }

    .row-icon {
        width: 24px;
        height: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .row-icon img, .row-icon svg {
        width: 100%;
        height: 100%;
        object-fit: contain;
    }

    .row-title {
        color: #e0e0e0;
        font-weight: 500;
        font-size: 0.95rem;
        border-bottom: 1px solid transparent;
        transition: border-color 0.2s;
    }
    
    .notion-row:hover .row-title {
        color: #1e90ff;
    }

    .row-right {
        display: flex;
        gap: 6px;
    }

    /* --- Tags System --- */
    .tag {
        padding: 2px 8px;
        border-radius: 4px;
        font-size: 0.75rem;
        font-weight: 500;
        line-height: 1.4;
        white-space: nowrap;
    }

    .easy { background: rgba(39, 201, 63, 0.15); color: #27c93f; }
    .medium { background: rgba(255, 189, 46, 0.15); color: #ffbd2e; }
    .hard { background: rgba(255, 95, 86, 0.15); color: #ff5f56; }
    .insane { background: rgba(142, 68, 173, 0.15); color: #bf5af2; }
    .windows { background: rgba(0, 120, 215, 0.15); color: #5ca0f2; }
    .linux { background: rgba(240, 173, 78, 0.15); color: #f0ad4e; }
    .os { opacity: 0.8; }

    @media (max-width: 600px) {
        .notion-header, .notion-body { padding: 0 20px; }
        .page-title { font-size: 1.8rem; }
        .col-tags { display: none; } 
        .tag.os { display: none; }
    }
</style>
{{ end }}