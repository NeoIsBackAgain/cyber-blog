
.toc.wide {
  position: fixed;
  inset-block-start: calc(var(--toc-gap) + 1px);
  inset-inline-start: var(--toc-gap);
  width: var(--toc-width);
  font-size: var(--toc-font-size);
  background: transparent;
  padding: 0;
  overflow-y: auto;
  max-block-size: calc(100vh - 140px);
  scrollbar-width: thin;
  scrollbar-color: #FF69B4 transparent;
}

/* Better semantic naming + modern properties */
.toc-section {
  margin-block-end: 0.35em;
}

.toc-summary {
  cursor: pointer;
  font-weight: 550;
  user-select: none;
  display: flex;
  align-items: center;
  gap: 0.5em;
  padding: 0.4em 0.6em;
  border-radius: 6px;
  transition: 
    background-color 0.2s ease,
    color 0.2s ease;
}

.toc-summary:hover,
.toc-summary:focus-visible {
  background-color: rgba(100, 150, 255, 0.1);
  color: #1e90ff;
}

.toc-list {
  list-style: none;
  margin: 0;
  padding-inline-start: 1.2em;
  overflow: hidden;
  
  /* The key fix is here */
  max-block-size: var(--max-height-collapsed);
  transition: max-block-size var(--transition-time) ease;
}

/* Open state — generous value */
.toc-section.open > .toc-list {
  max-block-size: var(--max-height-open);
}

/* Always expanded important levels */
.toc-section.level-1 > .toc-list,
.toc-section.level-2 > .toc-list {
  max-block-size: var(--max-height-level1);
}

.toc-section.level-2 > .toc-list {
  max-block-size: var(--max-height-level2);
}

/* Active link */
.toc a.active,
.toc a.active .toc-summary {
  font-weight: 700;
  color: #1e90ff;
}

/* Visual hierarchy indicators (optional but nice) */
.toc-section.level-3 .toc-summary::before { content: "– ";  color: #777; }
.toc-section.level-4 .toc-summary::before { content: "· ";   color: #999; }

/* Very deep nesting fallback */
.toc-section.open > .toc-list:has(.toc-section) {
  overflow-y: auto;
  max-block-size: 1800px;   /* prevent insane height on huge documents */
}

/* Optional: nice little arrow indicator */
.toc-summary::after {
  content: "›";
  margin-inline-start: auto;
  font-size: 8rem;
  color: #888;
  transition: transform 0.3s ease;
  transform: rotate(0deg);
}

.toc-section.open > .toc-summary::after {
  transform: rotate(90deg);
}


